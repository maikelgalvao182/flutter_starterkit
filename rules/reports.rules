/// ðŸš© Regras de SeguranÃ§a para Reports
/// 
/// ColeÃ§Ã£o: reports/{reportId}
/// 
/// CaracterÃ­sticas:
/// - Apenas usuÃ¡rios autenticados podem criar reports
/// - NinguÃ©m pode ler reports (apenas admins via console/backend)
/// - Mensagem limitada a 2000 caracteres
/// - Campos obrigatÃ³rios validados

match /reports/{reportId} {
  // âŒ NinguÃ©m pode ler reports (seguranÃ§a e privacidade)
  allow read: if false;
  
  // âœ… Apenas usuÃ¡rios autenticados podem criar reports
  allow create: if isSignedIn()
    && request.resource.data.keys().hasAll([
      'reporterId', 'message', 'createdAt', 'platform', 'appVersion'
    ])
    && request.resource.data.reporterId == request.auth.uid
    && request.resource.data.message is string
    && request.resource.data.message.size() >= 10
    && request.resource.data.message.size() <= 2000
    && request.resource.data.platform is string
    && request.resource.data.appVersion is string;
  
  // âŒ NinguÃ©m pode atualizar ou deletar reports
  allow update, delete: if false;
}
