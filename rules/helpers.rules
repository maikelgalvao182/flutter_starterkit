/// ğŸ” FunÃ§Ãµes auxiliares de autenticaÃ§Ã£o/autorizaÃ§Ã£o
/// Usadas em todos os arquivos de rules

function isSignedIn() {
  return request.auth != null;
}

function isOwner(userId) {
  return isSignedIn() && request.auth.uid == userId;
}

function isVip(userId) {
  let user = get(/databases/$(database)/documents/Users/$(userId));
  return user.data.user_is_vip == true ||
         (user.data.vipExpiresAt != null && 
          user.data.vipExpiresAt > request.time);
}

function isEventCreator(eventId) {
  return isSignedIn() && 
    get(/databases/$(database)/documents/events/$(eventId)).data.createdBy == request.auth.uid;
}

function isEventParticipant(eventId) {
  return isSignedIn() && 
    request.auth.uid in get(/databases/$(database)/documents/events/$(eventId)).data.participants.participantIds;
}

function isParticipant(u1, u2) {
  return isSignedIn() && (request.auth.uid == u1 || request.auth.uid == u2);
}
