/// ğŸ” FunÃ§Ãµes auxiliares de autenticaÃ§Ã£o/autorizaÃ§Ã£o
/// Usadas em todos os arquivos de rules

function isSignedIn() {
  return request.auth != null;
}

function isOwner(userId) {
  return isSignedIn() && request.auth.uid == userId;
}

function isEventCreator(eventId) {
  return isSignedIn() && 
    get(/databases/$(database)/documents/events/$(eventId)).data.createdBy == request.auth.uid;
}

function isEventParticipant(eventId) {
  return isSignedIn() && 
    request.auth.uid in get(/databases/$(database)/documents/events/$(eventId)).data.participants.participantIds;
}
